vpp.service

# CPUSET
# cpusets are represented by folders in /sys/fs/cgroup/cpuset
## build cage
cset shield --sysset=freeset --userset=vppcage --cpu=2-15 --kthread=on
## list procs of cupsets
cset proc --list --set vppcage
## run something in the cage
cset proc --set vppcage --exec -- ./run.sh asdf

extras/vpp_config/data/startup.conf.template

vppctl show int
show ip arp
show ip fib
show l2fib verbose
show int addr
show threads
show dpdk interface hqos placement
show dpdk interface hqos INTERFACE
show hardware-interfaces  detail
# show err <=> node mapping
show err

trace add dpdk-input 10 # or virtio-input or af-packet-input
trace show
clear trace

vppctl -s localhost:5002

/usr/bin/vpp -c /etc/vpp/startup.conf
vpp unix interactive

# for v18.04-rc2
----------------
rm -f /dev/shm/db /dev/shm/global_vm /dev/shm/vpe-api
modprobe uio_pci_generic
./vpp/build-root/install-vpp-native/vpp/bin/vpp unix interactive plugin_path ./vpp/build-root/install-vpp-native/vpp/lib64/vpp_plugins
# for debian vms:
-----------------
append vfio_pci ids=8086:100e to /etc/initramfs-tools/modules
update-initramfs -u
apt install dpdk-igb-uio-dkms
modprobe uio
modprobe igb_uio
# better debian vms:
-------------------
modprobe uio_pci_generic
echo "0000:00:0c.0" | tee /sys/bus/pci/devices/0000:00:0c.0/driver/unbind
echo 8086 100f | tee /sys/bus/pci/drivers/uio_pci_generic/new_id
# driver is now in place, but moongen and vpp hangs up at e1000_init_nvm_params_82540
# didnt work nvm
# with vagrant using libvirt
---------------------------
install vagrant on host
vagrant plugin install vagrant-libvirt
vagrant plugin install vagrant-mutate
vagrant box add puppetlabs/ubuntu-16.04-64-nocm --provider=virtualbox
vagrant mutate puppetlabs/ubuntu-16.04-64-nocm libvirt



# pos results end up in
/srv/testbed/results/manual_test_okelmann

./ba-okelmann/MoonGen/build/MoonGen ba-okelmann/MoonGen/examples/l3-load-latency.lua 1 0

l2fib add 00:11:22:33:44:55 1 TenGigabitEthernet5/0/1
# add 4 sequential macs
test l2fib add mac 52:54:00:53:00:00 count 4

set interface state TenGigabitEthernet5/0/1 up
set int ip address TenGigabitEthernet5/0/1 10.10.1.2/24
set ip arp count 1 TenGigabitEthernet5/0/1 10.10.1.3 dead.beef.babe
ip route add count 1 6.0.1.2/32 via 6.0.0.1 TenGigabitEthernet5/0/1

set int state GigabitEthernet4/0/0 up
set int state GigabitEthernet4/0/1 up
set int ip address GigabitEthernet4/0/0 10.10.1.2/24
set int ip address GigabitEthernet4/0/1 10.10.2.2/24
ip route add 10.1.0.10/16 via 10.10.2.2
set int l2 bridge GigabitEthernet4/0/0 1
set int l2 bridge GigabitEthernet4/0/1 1
show bridge-domain 1 detail

create loopback interface
show int
set interface l2 bridge loop0 1 bvi
set int state loop0 up
set int ip address loop0 10.10.3.2/24

set int state TenGigabitEthernet5/0/0 up
set int state TenGigabitEthernet5/0/1 up
set int l2 bridge TenGigabitEthernet5/0/0 1
set int l2 bridge TenGigabitEthernet5/0/1 1
